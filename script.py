import re

from utils.global_utils import RULE_DB_PATH, GLOBAL_DB_PATH, TASK_DB_PATH

input_text = """
客户ID,客服ID,消息内容,发送方,发送时间,对话ID
客户1,客服1,你们公司的产品质量怎么样?我看到有些差评说很一般。,1,2023/10/16 14:00,1
客户1,客服1,您好，非常感谢您的疑问。我们公司一直非常重视产品质量，任何质量问题都会受到高度重视并及时改正。如果您在使用过程中遇到任何问题，欢迎随时反馈给我们。,0,2023/10/16 14:05,1
客户1,客服1,那好吧，不过我还是有点担心。你能保证如果我购买后出现问题，可以无条件退换吗?,1,2023/10/16 14:10,1
客户1,客服1,当然可以，我们有完善的售后服务体系，只要是我们公司产品的质量问题，都可以无条件退换。亲爱的客户请放心购买。,0,2023/10/16 14:15,1
客户2,客服2,你好，我最近买的这款产品有个功能用不了。,1,2023/10/17 11:20,2
客户2,客服2,非常抱歉给您带来了不便，请问是哪个功能无法使用呢?您可以描述下具体情况吗?,0,2023/10/17 11:25,2
客户2,客服2,就是它的无线连接功能，我按说明操作后就是没反应。,1,2023/10/17 11:30,2
客户2,客服2,了解了，谢谢详细描述。那个无线连接功能确实比较容易出现连接失败的问题，我建议您可以先尝试重启设备，或检查下无线网络信号是否正常。如果还是无法连接，欢迎拨打我们的售后热线，工作人员会远程为您诊断和解决。,0,2023/10/17 11:35,2
客户3,客服3,我想换一下你们的其他产品，这个用起来还是有些不习惯。,1,2023/10/18 16:40,3
客户3,客服3,好的尊敬的客户，请问您需要换成我们哪一款产品呢?我这边可以为您比较一下不同型号的参数配置，确保更换后能完全满足您的需求。,0,2023/10/18 16:45,3
客户3,客服3,嗯，就是你们最新上市的那款吧，听说性能不错。,1,2023/10/18 16:50,3
客户3,客服3,了解了，您说的应该是我们最新款的XX型号。它在CPU、内存、续航等各方面的确有了非常大的提升，是目前我们旗舰级产品。如果您对其性能、使用体验等有任何疑问，我都可以为您详细解答。,0,2023/10/18 16:55,3
客户4,客服4,您好,我最近购买了你们公司的产品,总体还可以,就是有一些小瑕疵。,1,2023/11/20 09:30,4
客户4,客服4,非常抱歉给您带来了不佳的体验。能否详细描述一下您遇到的问题呢?我们一定会及时改正。,0,2023/11/20 09:35,4
客户4,客服4,嗯,就是外观有些划痕,而且无线连接也不太稳定。我对这个产品还是比较失望的。,1,2023/11/20 09:40,4
客户4,客服4,太抱歉了,我完全理解您对产品质量的不满。我们将立即反馈给相关部门,尽快优化产品质量。作为补偿,我这边可以为您免费更换一台新机,并享受折扣优惠购买其他配件。还请您多多包涵。,0,2023/11/20 09:45,4
客户5,客服5,你好,我看了你们最新的产品介绍,感觉很不错。但是我对哪款更合适还是比较迷茫的。,1,2023/11/21 14:10,5
客服5,客户5,非常感谢您对我们产品的关注。不知您主要是用于什么场景呢?根据您的使用需求,我可以为您推荐最合适的型号。,0,2023/11/21 14:15,5
客户5,客服5,主要是家庭日常使用,需要性能稳定一些,其他没有太多特殊要求。,1,2023/11/21 14:20,5
客服5,客户5,了解了,根据您的需求,我给您推荐我们的XX款吧。这款采用了行业顶级的芯片,运行内存也比较大,能够确保长期稳定高效的使用体验。而且做工精细、外观时尚,非常适合家庭使用场景。您可以考虑下这个型号。,0,2023/11/21 14:25,5
客户6,客服6,你们的售后服务怎么样?有没有七天无理由退货政策?,1,2023/11/22 16:45,6
客服6,客户6,亲爱的客户您好,我们一直非常重视售后服务工作。所有产品都享受15天无理由退货,90天免费保修的政策。如果在使用过程中出现任何质量问题,我们也会及时免费维修或者换新。,0,2023/11/22 16:50,6
客户6,客服6,那太好了,之前在别的商家遇到过退货很麻烦的情况,希望你们这边不会那样。,1,2023/11/22 16:55,6
客服6,客户6,完全不会的,退货流程非常简便。只需要准备好购买凭证和完好包装箱,通过快递将产品寄回我司即可,费用也由我们承担。售后人员会及时为您办理退货手续,给您一个满意的答复。,0,2023/11/22 17:00,6
客户7,客服7,你们公司最新的那款笔记本电脑评价怎么样?值得入手吗?,1,2023/11/23 10:15,7
客服7,客户7,这款新品的综合表现确实非常出色。作为我们旗舰产品,CPU、显卡等硬件配置都是行业顶级,能轻松满足各类办公和娱乐需求。此外,全金属机身、长待机、超窄边框等人性化设计也获得了业界一致好评。,0,2023/11/23 10:20,7
客户7,客服7,听起来很不错,不过价格是不是有点高啊?,1,2023/11/23 10:25,7
客服7,客户7,您提出了一个非常好的疑问。虽然售价确实比普通机型偏高一些,但相比其硬件规格和人性化体验来说,性价比其实很高。更重要的是,我们正在针对这款新品推出优惠政策,如果在本月内购买将享受8折优惠,费用已经更加亲民了。,0,2023/11/23 10:30,7
客户8,客服8,您好,我是不是可以现在就立即下单?这款新品现在有现货吗?,1,2023/11/24 14:40,8
客服8,客户8,尊敬的客户您好,非常感谢您对我们产品的青睐。这款新品现在全国范围内都有现货供应,如果您现在就下单的话,将在1-3个工作日内为您发货。,0,2023/11/24 14:45,8
客户8,客服8,好的,那我现在就在网上下单了,这个新品太让我心动了。,1,2023/11/24 14:50,8
客服8,客户8,非常感谢您的订购!这绝对是一个正确的选择。我们将迅速为您处理订单,并确保产品状态良好。再次感谢您的支持与厚爱,祝您使用愉快!,0,2023/11/24 14:55,8
客户9,客服9,你好,我昨天购买了你们的新手机,现在已经收到了。有什么要注意的吗?该怎么激活使用?,1,2023/11/25 11:10,9
客服9,客户9,您好,非常感谢您选购我们的新品手机!使用前的准备工作非常简单。首先请取出手机和电源适配器,给电池充满电。然后按下电源键开机,根据屏幕指引完成初始设置即可。如果在操作过程中有任何疑问,欢迎随时咨询我们。,0,2023/11/25 11:15,9
客户9,客服9,好的,谢谢您的指导。对了,这款新机的拍照功能应该如何使用?能详细介绍一下吗?,1,2023/11/25 11:20,9
客服9,客户9,非常感谢您对我们手机拍照功能的关注。这款新机拥有业界顶级的AI智能相机系统,其人像模式、夜景、美颜等拍照功能都处于领先水平。您只需打开相机应用,根据场景选择对应模式即可,非常简便易用。我这里还有详细的拍照攻略,需要的话可以发给您。,0,2023/11/25 11:25,9
客户10,客服10,我对你们新上市的平板电脑还是比较感兴趣的,不过实体店看了下貌似和宣传的不太一样。实体店的那个款式到底怎么回事? ,1,2023/11/26 15:35,10
客服10,客户10,非常感谢您对我们新品平板电脑的关注。根据您的描述,我判断您可能看到了我们之前发布的某一款样机。新品与样机在细节上的确有一些区别,不过大体方案是没有改变的。具体规格配置可以参考我们官网或者实体店介绍。,0,2023/11/26 15:40,10
客户10,客服10,那这个新品到底有什么亮点?和其他品牌有何区别?您老给我分析分析吧。,1,2023/11/26 15:45,10
客服10,客户10,好的,我这就为您详细介绍一下。我们这款新品平板电脑最大的特点就是集高端和极致轻薄于一体。采用了行业顶级的芯片和大容量内存,但机身仅4.8毫米超薄,重量不足300克。应用体验丝毫不输台式机。此外,独特的三防设计可以防尘防水防摔。再加上超长待机等黑科技,真正将性能和便携融合得天衣无缝。,0,2023/11/26 15:50,10
客户11,客服11,最近看到你们新推出的智能音箱,想请教下使用体验如何?,1,2023/11/27 09:25,11
客服11,客户11,非常感谢您对我们新品的关注。这款智能音箱不仅音质出众,支持无损音频解码,而且语音交互体验也相当人性化。它能够精准识别语音指令,对多种复杂命令都可以快速理解和执行,无论是音乐播放、天气查询还是在线购物,使用都非常便捷。,0,2023/11/27 09:30,11
客户11,客服11,听起来很不错,不过据说续航时间比较短?这个问题有没有得到改善?,1,2023/11/27 09:35,11
客服11,客户11,您提出了一个好问题。此前早期版本的确存在电池续航有限的问题。但我们最新的这一代智能音箱已经在电池容量和待机耗电上做了全面升级,使用3-4周无需充电完全无压力。即便长期使用也一定能给您留下极佳的用户体验。,0,2023/11/27 09:40,11
客户12,客服12,不知这次你们新手机的拍照功能如何?我是一个比较喜欢摄影的人。,1,2023/11/28 14:10,12
客服12,客户12,新机的影像系统绝对是一大看点。我们不仅在硬件上采用了新一代AI超级夜视相机,支持夜景视频防抖等黑科技,软件算法方面也做了大量人性化优化,肖像渲染、长曝光、美颜美肤等功能都领先同行。即便是在夜间或是阴暗环境,相机依然能捕捉高质量的细节。,0,2023/11/28 14:15,12
客户12,客服12,听起来很让人期待,不过这样高端的相机配置售价应该很高吧?对于一般消费者来说能承受得了吗?,1,2023/11/28 14:20,12
客服12,客户12,关于这一点请您放心。我们在定价时非常注重性价比,绝不会让普通用户觉得太贵。实际上,新机的公司指导价已经比市面上同等配置的产品便宜不少。而且我们还推出了分期免息和老用户优惠等政策,让更多人都能体验到旗舰影像的乐趣。,0,2023/11/28 14:25,12
客户13,客服13,你好,我最近购买了你们的新款笔记本电脑,结果出现了一些故障。具体是开机就自动重启,一直循环这个过程。,1,2023/11/29 10:35,13
客服13,客户13,非常抱歉给您带来了这么大的不便,我们一定会尽快协助您解决。能否请您描述一下具体使用的是哪个型号?是否也可以将故障现象拍个视频发给我,方便我们分析原因。,0,2023/11/29 10:40,13
客户13,客服13,好的,是XXXX型号的,视频我这就拍一段发给你。不过现在这个状况我根本没法正常使用机器,我是想尽快换一台新的,行吗?,1,2023/11/29 10:45,13
客服13,客户13,确实,我们会优先考虑为您更换一台新机。请您将故障描述、视频和购买凭证一并发给我,我们会立即着手为您办理新机更换手续。如果在这个过程中遇到任何其他问题,也尽管继续反馈给我们。确保让您早日使用上全新的笔记本,我们将不惜一切代价。,0,2023/11/29 10:50,13
客户14,客服14,你们公司新推出的平板电脑我在上个月就预订了,但一直没收到,已经快1个多月了,发货情况怎么样?,1,2023/11/30 16:25,14
客服14,客户14,非常感谢您的谅解与等待。这款新品平板电脑自上市以来反响热烈,订单量超出了我们的预期,所以出现了发货延迟的情况。但请放心,我们已经大量加紧供货。根据我手上的信息,您的订单预计将在3-5个工作日内发出。实在给您带来诸多不便,我们会优先处理您的订单,并为您提供相应的延误补偿。,0,2023/11/30 16:30,14
客户14,客服14,3-5天的话还好,只要别再拖就行。不过你们也应该好好改进一下供货和发货的效率,要不就是损失大量潜在客户。,1,2023/11/30 16:35,14
客服14,客户14,您说得非常有道理,我们确实在这方面做得还不够好。我已将您的宝贵意见反馈给了上级,我们会从供应链、物流等多方面着手优化,尽最大努力避免类似延期情况再次发生。作为对您的补偿和道歉,您的订单将免费享受顺丰特惠服务,确保快递时效。希望您多多谅解。,0,2023/11/30 16:40,14
客户15,客服15,你们公司的新款无线耳机怎么样?音质和防水表现如何?,1,2023/12/1 11:10,15
客服15,客户15,非常感谢您对我们新品无线耳机的关注。这款耳机采用了独家开发的混合主动降噪技术,能最大程度滤除外界噪音,还原出原汁原味的高品质音效。此外,它还通过了IP67级别的严苛防水测试,即便在户外下雨天也可以放心佩戴使用。无论是通勤通话还是户外运动,这款耳机都能给您带来极佳的体验。,0,2023/12/1 11:15,15
客户15,客服15,听起来很不错,不过续航时间够用吗?我平时也是经常需要长时间使用。,1,2023/12/1 11:20,15
客服15,客户15,您提出了一个非常好的疑虑。这款耳机的续航表现同样出色,单次使用可达8小时,再配合便携式充电盒使用,总待机时间高达24小时。即便是户外长途旅行,也完全可以满足您的使用需求。当然,如果您对续航时间仍有其他疑问,我这里还有详细的电池数据资料,随时欢迎您查阅。,0,2023/12/1 11:25,15
客户16,客服16,你们最新款的智能电视盒子是否支持4K分辨率?系统界面简洁吗?,1,2023/12/2 14:40,16
客服16,客户16,是的,我们最新一代的智能电视盒子完全支持目前最高的4K超高清分辨率,色彩还原和细节层次都达到了业界领先水平。同时,我们也在系统界面方面下了很大功夫,通过精简布局和人性化设计,使操作变得前所未有的直观简洁。即便是老年人也能快速上手,无需花太多精力学习使用。,0,2023/12/2 14:45,16
客户16,客服16,听起来很不错啊。那请问这款盒子的接口是否足够多?我有很多外设需要连接。,1,2023/12/2 14:50,16
客服16,客户16,完全不用担心这个问题。我们在硬件接口方面一直非常用心,除了标配的HDMI、网口等基础接口外,还提供了3个USB3.0接口以及无线投屏功能。您完全可以同时连接游戏手柄、硬盘、键盘等多种外设,完美满足各种使用场景。毕竟这也正是我们的初衷所在,为用户打造高度智能且联网性极强的家庭影音中心。,0,2023/12/2 14:55,16
客户17,客服17,你好,最近在论坛上看到有人反馈你们最新的笔记本电脑出现了自动重启的故障,这到底是什么情况?是硬件还是系统问题?我最近也在考虑购买那款机型,所以非常在意这个问题。,1,2023/12/3 10:15,17
客服17,客户17,非常感谢您的提醒。我们对于那个自动重启的反馈确实高度重视,并已着手紧急调查和修复。初步判断,导致这一故障的主要原因是某一细小硬件驱动的兼容性问题,但整体上我们的产品质量完全没有任何疑虑。所有符合条件的用户,我们都将为其免费更换新品或提供相关的补救措施。,0,2023/12/3 10:20,17
客户17,客服17,那就好,希望你们能尽快全面解决这个问题。既然如此,那我对这款笔记本是否还值得购买也就没有那么多疑虑了。,1,2023/12/3 10:25,17
客服17,客户17,非常感谢您的谅解,我们一定会尽快彻底解决这一问题。这款笔记本是我们公司今年的重点产品,无论是硬件配置还是系统体验都代表了我们的最新科技水平,大可放心选购。当然,如果您对任何细节有疑问,我们的技术人员也可以在购买前为您进一步解答。,0,2023/12/3 10:30,17
客户18,客服18,你们公司的新款智能手表上市了吗?听说它的健康监测功能很强大,我很感兴趣想入手。,1,2023/12/4 15:50,18
客服18,客户18,是的,这款集健康监测于一身的智能手表已经在上周正式上市开售了。您对它的关注非常正确,它搭载了多项全新的健康科技,可以实现24小时不间断监测心率、睡眠、血氧等多种身体数据。此外,它还支持多种户外运动模式和精准卫星定位导航,对于运动爱好者来说也是非常实用。,0,2023/12/4 15:55,18
客户18,客服18,听起来很不错啊。这手表的续航时间够用吗?我可能要长时间佩戴使用它,如果电池太快没电就不方便了。,1,2023/12/4 16:00,18
客服18,客户18,您提出了一个非常好的疑问。这一代手表在电池寿命方面我们做了诸多优化,单次充电可使用7天以上,日常使用完全足够。即便是开启了所有监测功能,也至少可使用48小时以上。更重要的是,它还支持无线快充,只需15分钟就可以恢复大半的电量,补给非常方便。综合续航和快充来看,它绝对能满足您长期佩戴的需求。,0,2023/12/4 16:05,18
客户19,客服19,你好,我最近购买了你们的新款平板电脑,但是在使用时出现了一些问题。就是偶尔会无故发生系统死机,甚至一度无法重启,这种情况持续了好几次了。,1,2023/12/5 11:20,19
客服19,客户19,非常抱歉给您的使用带来了这么大的不便,我们一定会高度重视并及时协助解决。能否请您描述一下具体的死机现象?比如是在什么情况下发生、有无报错提示等,并将相关日志和截图发给我一份。只要掌握了问题根源,我们就可以有的放矢地进行修复。,0,2023/12/5 11:25,19
客户19,客服19,好的,我这就尝试录制一个视频给你。不过这简直让人抓狂,我当初购买的目的就是为了高效办公,现在频繁死机影响太大了,能否先给我换一台新的设备?我实在等不及修复。,1,2023/12/5 11:30,19
客服19,客户19,我完全理解您的心情,出现这种故障确实影响太大了。为了最大程度消除您的后顾之忧,我这边现在就为您启动新机更换流程,您尽管将故障信息发给我备案就好。新平板一旦到货,我们将火速为您免费更换,绝不延误。同时我们也会继续跟踪故障原因,努力避免同类问题再次发生。,0,2023/12/5 11:35,19
"""
# Split the input text into lines for processing
lines = input_text.strip().split("\n")

# Define a pattern to match records and a subpattern for the "消息内容" field
record_pattern = re.compile(r'^([^,]+,[^,]+,)([^,]+)(,.+)$')


# Function to replace Chinese commas within the "消息内容" field only
def replace_commas_in_message_content(text):
    lines = text.strip().split('\n')  # Split the input text into lines
    processed_lines = [lines[0]]  # Add the header line as it is

    for line in lines[1:]:  # Skip header line
        fields = line.split(',')  # Split each line into fields based on commas

        # The "消息内容" field can be found at index 2, but since there might be commas within the field itself,
        # we need to handle this carefully Reconstruct the "消息内容" field considering that it might have been split
        # incorrectly due to internal commas
        message_content = ','.join(
            fields[2:-3])  # Rejoin the message content, assuming the last 3 fields are always "发送方,发送时间,对话ID"
        message_content_replaced = message_content.replace(',',
                                                           '，')  # Replace commas with Chinese commas in the message
        # content

        # Reassemble the line with the updated message content
        new_line = ','.join(fields[:2] + [message_content_replaced] + fields[-3:])
        processed_lines.append(new_line)

    return '\n'.join(processed_lines)  # Join the lines back together into a single string


#
# print(replace_commas_in_message_content(input_text))

import difflib


def string_similar(s1, s2):
    """
    对比话术相似度。尝试在长句中匹配到短句。

    :param s1: 第一个字符串（较短的字符串）
    :param s2: 第二个字符串（较长的字符串）
    :return: 二者相似度
    """
    # 确保 s1 是较短的字符串
    if len(s1) > len(s2):
        s1, s2 = s2, s1

    max_ratio = 0
    # 遍历长句，提取与短句长度相同的子句，比较相似度
    for i in range(len(s2) - len(s1) + 1):
        part = s2[i:i + len(s1)]
        ratio = difflib.SequenceMatcher(None, s1, part).quick_ratio()
        max_ratio = max(max_ratio, ratio)

    formatted_similarity = f"{max_ratio * 100:.1f}%"
    return formatted_similarity


import json

# 修正：包含 json 库

# 重新构造示例数据
data = [
    {
        "dialogue": [
            {"role": "user", "text": "你好，我上周买的电脑鼠标不工作了，我想退货。"},
            {"role": "agent", "text": "您好，请问您有保留购买凭证吗？"},
            {"role": "user", "text": "有的，我现在就能给你发。"},
            {"role": "agent", "text": "好的，请您发送凭证和故障鼠标的照片。"},
            {"role": "user", "text": "[发送凭证和照片]"},
            {"role": "agent", "text": "收到了，我们会尽快为您处理退货。"}
        ],
        "analysis": "客服的响应速度很快，提问清晰具体，礼貌且有效地引导用户提供了解决问题所需的信息。但是，客服没有表达对用户遇到不便的同情或道歉，这是可以改进的地方。"
    },
    {
        "dialogue": [
            {"role": "user", "text": "我的账号好像被人盗了，我现在登不上去。"},
            {"role": "agent", "text": "非常抱歉听到这个情况。为了验证您的身份，请提供注册邮箱和最后一次成功登录的时间。"},
            {"role": "user", "text": "[提供信息]"},
            {"role": "agent",
             "text": "感谢您的配合，我们已经暂时冻结了您的账号，以防进一步损失，并将指导您通过邮件重置密码。"},
            {"role": "user", "text": "好的，谢谢。"}
        ],
        "analysis": "客服对用户遇到的安全问题表现出了同情，并迅速采取了措施来保护用户的账号安全。客服同时也有效地引导用户进行了下一步操作，表现良好。"
    },
    {
        "dialogue": [
            {"role": "user", "text": "你们现在有没有进行任何促销活动？"},
            {"role": "agent", "text": "您好！目前我们有多项促销活动。您对哪一类产品感兴趣？"},
            {"role": "user", "text": "我对手机感兴趣。"},
            {"role": "agent", "text": "好的，我们现在有若干款手机参与特价活动。我给您发一份活动清单，请查收。"},
            {"role": "user", "text": "收到了，谢谢。"}
        ],
        "analysis": "客服回答及时，提供了用户需要的具体信息，并主动提供了额外的帮助，表现出了良好的服务态度和效率。"
    },
    # 场景1：产品咨询
    {
        "dialogue": [
            {"role": "user", "text": "请问这款智能手表支持游泳时佩戴吗？"},
            {"role": "agent", "text": "是的，这款手表支持IP68防水，可以在游泳时佩戴。"},
        ],
        "analysis": "客服提供了明确且有用的产品信息，表现出了良好的产品知识和服务态度。"
    },
    # 场景2：快递查询
    {
        "dialogue": [
            {"role": "user", "text": "我的包裹为什么还没到？"},
            {"role": "agent", "text": "请提供一下您的订单号。"},
            {"role": "user", "text": "订单号是789012。"},
            {"role": "agent", "text": "您的包裹正在路上，由于天气原因导致了延误，预计明后两天内到达。"}
        ],
        "analysis": "客服及时回应，并给出了合理解释及预期的解决时间，处理得当。"
    },
    # 场景3：退款流程
    {
        "dialogue": [
            {"role": "user", "text": "我想知道退款流程是怎样的？"},
            {"role": "agent",
             "text": "首先，请您在我们的网站或APP中申请退款，附上订单号和退款理由，我们的客服将会在24小时内处理您的退款请求。"}
        ],
        "analysis": "客服清晰地解释了退款流程，响应迅速，提供了有效的操作指导。"
    },
    # 场景4：账户安全
    {
        "dialogue": [
            {"role": "user", "text": "我怀疑我的账户被盗用了，应该怎么办？"},
            {"role": "agent",
             "text": "请立即修改您的账户密码，并检查账户中的绑定邮箱和电话号码是否是您的，如果有异常，请尽快联系我们进行进一步的安全措施。"}
        ],
        "analysis": "客服给出了紧急且实用的建议来保障账户安全，表现出了对客户问题的关注和专业的处理能力。"
    },
    # 场景5：产品不满意
    {
        "dialogue": [
            {"role": "user", "text": "我对我购买的产品非常不满意，我可以退货吗？"},
            {"role": "agent",
             "text": "很抱歉让您不满意，请问能告诉我具体的问题吗？我们也许可以帮您解决。如果您仍然想要退货，我们当然可以为您办理。"}
        ],
        "analysis": "客服表现出了关心客户的不满意感受，并提供了解决方案和退货的选择，兼顾了客户满意度和问题解决。"
    },
    # 场景6：优惠券使用
    {
        "dialogue": [
            {"role": "user", "text": "我有一张优惠券，怎么使用呢？"},
            {"role": "agent",
             "text": "请在结账时选择“使用优惠券”选项，并输入您的优惠券代码，如果有任何问题，请随时联系我们。"}
        ],
        "analysis": "客服详细解释了使用优惠券的步骤，语言简洁明了，展现了良好的帮助意愿。"
    },
    {
        "dialogue": [
            {"role": "user", "text": "我在找一款适合初学者的数码相机，你们有推荐的吗？"},
            {"role": "agent",
             "text": "当然，根据您的需求，我推荐我们的XX品牌新款数码相机，它非常适合初学者，操作简便，同时拥有高品质的成像效果。"}
        ],
        "analysis": "客服不仅提供了产品推荐，还详细说明了推荐理由，展示了对用户需求的理解和专业的产品知识。"
    },
    # 场景8：发票问题
    {
        "dialogue": [
            {"role": "user", "text": "我需要开具发票，应该怎么操作？"},
            {"role": "agent",
             "text": "请在订单详情页选择“申请发票”选项，并填写您的发票信息，我们会在商品发货后为您开具电子发票。"}
        ],
        "analysis": "客服详细地解释了开具发票的流程，响应迅速并提供了清晰的操作指导。"
    },
    {
        "dialogue": [
            {"role": "user", "text": "我不确定我的订单是否成功下达。"},
            {"role": "agent", "text": "没问题，您能提供订单号或者下单时使用的邮箱地址吗？"},
            {"role": "user", "text": "是的，我的邮箱是example@email.com。"},
            {"role": "agent", "text": "感谢提供信息，我查到了您的订单，已经成功下达并且正在处理中。"}
        ],
        "analysis": "客服有效利用了提供的信息迅速确认了订单状态，表现出了高效和专业性。"
    },
    {
        "dialogue": [
            {"role": "user", "text": "我昨天收到的商品有损坏，我该怎么办？"},
            {"role": "agent", "text": "非常抱歉听闻此事，为了帮助我们更好地解决问题，您能提供商品的照片和订单号吗？"},
            {"role": "user", "text": "[提供照片和订单号]"},
            {"role": "agent", "text": "收到了，我们会为您安排退换货服务，并对此次不便表示诚挚的歉意。"}
        ],
        "analysis": "客服在处理用户的投诉时表现出同情和效率，快速响应了解决方案。"
    },
    {
        "dialogue": [
            {"role": "user", "text": "我想了解下你们的退款政策。"},
            {"role": "agent", "text": "关于退款，我们提供30天内无理由退款服务。只需您保持商品完好，就可以申请退款。"},
            {"role": "user", "text": "如果商品有质量问题呢？"},
            {"role": "agent", "text": "如果是因为质量问题，退货运费将由我们承担，并全额退款。"}
        ],
        "analysis": "客服提供了详细的退款政策说明，对用户的额外问题也给予了清晰的回答。"
    },
    {
        "dialogue": [
            {"role": "user", "text": "你们的网站上找不到我想要的书。"},
            {"role": "agent", "text": "请问您能告诉我书的名称或者ISBN码吗？我可以帮您查找。"},
            {"role": "user", "text": "书名是《深入理解计算机系统》。"},
            {"role": "agent",
             "text": "感谢您的等待，我查到了该书目前缺货，预计下周会有新的库存到达。您要我帮您预留一本吗？"}
        ],
        "analysis": "客服通过提供信息查找服务并及时更新库存情况，展现了良好的客户服务态度。"
    },
    {
        "dialogue": [
            {"role": "user", "text": "我上次购买的电子产品出现了一些问题，能否帮忙解决？"},
            {"role": "agent", "text": "当然可以，麻烦您描述一下具体遇到的问题是什么？"},
            {"role": "user", "text": "它无法正常开机了。"},
            {"role": "agent", "text": "了解了。请问您是否尝试过任何故障排除步骤？"},
            {"role": "user", "text": "我尝试重置了，但没有用。"},
            {"role": "agent", "text": "明白了，我们建议您将产品送修，如果在保修期内，维修将是免费的。"}
        ],
        "analysis": "客服首先尝试了解详细情况并提供了初步的故障排除建议，最后给出了合理的解决方案。"
    },
    {
        "dialogue": [
            {"role": "user", "text": "我对贵公司的健身手环很感兴趣，但不确定它是否能跟踪游泳活动。"},
            {"role": "agent", "text": "我们的健身手环确实支持跟踪游泳活动，包括游泳时长和消耗的卡路里。"},
            {"role": "user", "text": "太好了！它是防水的吗？"},
            {"role": "agent", "text": "是的，手环拥有IP68级别的防水性能，可以在游泳时佩戴无忧。"}
        ],
        "analysis": "客服准确回答了用户的具体问题，并提供了产品的详细信息，展现出了良好的产品知识和服务态度。"
    },
    {
        "dialogue": [
            {"role": "user", "text": "我在贵网站上下单时遇到了支付问题。"},
            {"role": "agent", "text": "很抱歉给您带来不便。请问您能描述一下具体遇到的问题吗？"},
            {"role": "user", "text": "当我试图使用信用卡支付时，系统显示我的支付未成功。"},
            {"role": "agent",
             "text": "明白了，建议您检查一下卡信息是否输入正确，或者尝试使用其他支付方式。如果问题仍然存在，我们建议您联系银行确认卡状态。"}
        ],
        "analysis": "客服给出了具体的解决步骤，并提供了替代方案，处理问题的方法周到且实用。"
    },
    {
        "dialogue": [
            {"role": "user", "text": "我想取消我的订阅服务，应该怎么操作？"},
            {"role": "agent",
             "text": "我们很遗憾听到您想要取消订阅。您可以直接在我们的网站上的“我的账户”页面中取消，或者告诉我您的账户信息，我可以帮您操作。"},
            {"role": "user", "text": "我更希望您能帮我处理。"},
            {"role": "agent", "text": "当然可以，请提供您的账户邮箱地址。"}
        ],
        "analysis": "客服在处理取消订阅请求时提供了操作指南，并主动提出帮助，体现了良好的客户关怀。"
    },
    {
        "dialogue": [
            {"role": "user", "text": "我收到的包裹里少了一件商品。"},
            {"role": "agent", "text": "非常抱歉给您带来不便。为了帮您解决这个问题，能否提供您的订单号和缺失商品的名称？"},
            {"role": "user", "text": "订单号是12345，缺的商品是蓝色T恤。"},
            {"role": "agent", "text": "感谢您的信息，我现在为您核查。"}
        ],
        "analysis": "客服迅速响应并请求了必要的信息以便解决问题，展现出了有效的问题解决能力。"
    },
    {
        "dialogue": [
            {"role": "user", "text": "我对你们的退货政策有些疑问。"},
            {"role": "agent", "text": "请问您有什么具体的问题吗？我们的退货政策允许在商品收到后的30天内无理由退货。"},
            {"role": "user", "text": "如果我买的商品在使用一段时间后出现了问题，我还能退货吗？"},
            {"role": "agent",
             "text": "如果是因为产品质量问题，在保修期内是可以退货的。请问您的商品是什么时候购买的，以及具体是什么问题？"}
        ],
        "analysis": "客服提供了清晰的退货政策说明，并针对用户的具体情况提出了解决方法，体现了专业性和关心用户的态度。"
    },
    {
        "dialogue": [
            {"role": "user", "text": "双十一期间下的订单现在还没发货，是怎么回事？"},
            {"role": "agent",
             "text": "由于双十一期间订单量大增，我们的发货确实存在延迟。请您提供订单号，我帮您查看具体情况。"},
            {"role": "user", "text": "好的，订单号是11223344。"},
            {"role": "agent", "text": "已经查到您的订单了，预计将在本周内发出，给您带来不便敬请谅解。"}
        ],
        "analysis": "客服提供了订单状态的具体信息，并解释了延迟发货的原因，体现了对顾客的尊重和理解。"
    },
    {
        "dialogue": [
            {"role": "user", "text": "我想查询我的退款进度。"},
            {"role": "agent", "text": "好的，请提供一下您的退款订单号。"},
            {"role": "user", "text": "订单号是55667788。"},
            {"role": "agent", "text": "根据我们的记录，您的退款已于昨日处理。退款通常需要1-3个工作日到账，请您注意查收。"}
        ],
        "analysis": "客服详细解释了退款流程和时间，帮助用户了解退款状态，体现了专业和高效的服务态度。"
    },
    {
        "dialogue": [
            {"role": "user", "text": "我购买的手机屏幕出现了一条明显的划痕。"},
            {"role": "agent", "text": "非常抱歉给您带来的不便，请问您是否方便提供一张屏幕划痕的照片？"},
            {"role": "user", "text": "[发送照片]"},
            {"role": "agent", "text": "照片已收到，我们会为您申请换货。请您按照我们发送的换货流程操作，感谢您的配合。"}
        ],
        "analysis": "客服迅速响应用户的问题，并提供了换货解决方案，体现了高效和负责任的服务。"
    },
    {
        "dialogue": [
            {"role": "user", "text": "我在你们网站上买的鞋子大小不合适，能换一个号吗？"},
            {"role": "agent", "text": "当然可以，换货流程非常简单。请问您希望换成什么尺码？"},
            {"role": "user", "text": "我想换成42号的。"},
            {"role": "agent", "text": "好的，我已为您发起换货申请，详细流程已通过短信形式发送至您的手机，请按照指示操作。"}
        ],
        "analysis": "客服有效地解决了用户的换货需求，并通过短信发送了详细操作流程，服务周到细致。"
    },
    {
        "dialogue": [
            {"role": "user", "text": "我使用优惠券支付时提示已使用，但是我并没有使用过。"},
            {"role": "agent", "text": "这种情况我们需要进行详细的核查，请提供您的优惠券代码和使用时的订单号。"},
            {"role": "user", "text": "优惠券代码是A1B2C3，订单号是78901234。"},
            {"role": "agent", "text": "感谢您提供的信息，我们将尽快为您核查并解决问题。"}
        ],
        "analysis": "客服在面对用户的问题时，保持了耐心，并且要求用户提供详细信息以便快速解决问题，展现出了专业的服务态度。"
    },
    {
        "dialogue": [
            {"role": "user", "text": "我新买的手机充电非常慢，这是正常的吗？"},
            {"role": "agent", "text": "不正常，我们的手机支持快充技术。请问您是使用了原装充电器和充电线吗？"},
            {"role": "user", "text": "是的，全都是盒子里自带的。"},
            {"role": "agent",
             "text": "明白了，那请您尝试重启手机并检查是否有软件更新需要应用。如果问题仍然存在，请联系我们的售后服务进行进一步检查。"}
        ],
        "analysis": "客服提供了初步的故障排除方法，并指导用户进行软件更新检查，同时也预留了后续的售后服务选项，展现出了专业和负责的服务态度。"
    },
    {
        "dialogue": [
            {"role": "user", "text": "我的手机突然之间无法开机了。"},
            {"role": "agent",
             "text": "很抱歉给您带来不便。请问手机在无法开机之前有没有出现过任何异常现象，比如自动重启或者发热？"},
            {"role": "user", "text": "没有，就是突然用不了了。"},
            {"role": "agent",
             "text": "了解了，建议您先长按电源键10秒尝试强制重启。如果仍然无法开机，请携带购机发票和保修卡到就近的授权维修中心进行检查。"}
        ],
        "analysis": "客服首先指导用户进行强制重启尝试解决问题，随后提供了进一步的维修建议，体现了快速响应和解决问题的能力。"
    },
    {
        "dialogue": [
            {"role": "user", "text": "我手机上的一些应用总是自动退出，这是怎么回事？"},
            {"role": "agent", "text": "这可能是应用软件兼容性问题导致的。请问您是否尝试过更新这些应用到最新版本？"},
            {"role": "user", "text": "有一些我更新了，但问题还是存在。"},
            {"role": "agent",
             "text": "如果更新应用后问题仍旧存在，建议您备份重要数据后尝试恢复出厂设置。这样可以解决大部分软件兼容性问题。"}
        ],
        "analysis": "客服针对用户的问题提出了实用的解决方案，包括应用更新和恢复出厂设置，展现了专业的技术支持能力。"
    },
    {
        "dialogue": [
            {"role": "user", "text": "我想了解一下手机的保修政策。"},
            {"role": "agent",
             "text": "我们的手机提供一年保修服务，涵盖非人为损坏的硬件问题。请问您有遇到任何具体问题吗？"},
            {"role": "user", "text": "就是想了解下，没有遇到问题。"},
            {"role": "agent", "text": "好的，如果将来您遇到任何问题，都可以随时联系我们的客服或者就近的授权维修中心。"}
        ],
        "analysis": "客服清晰地解释了保修政策，并主动询问用户是否存在问题，体现了积极主动的服务态度。"
    },
    {
        "dialogue": [
            {"role": "user", "text": "我的手机最近老是发热，尤其是玩游戏的时候。"},
            {"role": "agent",
             "text": "手机在长时间高负荷运行时发热是正常现象。不过，如果发热程度过高，可能需要检查。请问发热是在使用特定应用时更明显吗？"},
            {"role": "user", "text": "对，玩某些游戏时特别明显。"},
            {"role": "agent",
             "text": "明白了，建议您定期清理手机后台应用，并尝试减少连续游戏时间。如果问题持续存在，建议您到授权维修中心进行专业检查。"}
        ],
        "analysis": "客服提出了合理的使用建议来减轻手机发热问题，并在必要时引导用户进行专业检查，既实用又负责。"
    },
    {
        "dialogue": [
            {"role": "user", "text": "我新买的手机充电非常慢，这是正常的吗？"},
            {"role": "agent", "text": "不正常，我们的手机支持快充技术。请问您是使用了原装充电器和充电线吗？"},
            {"role": "user", "text": "是的，全都是盒子里自带的。"},
            {"role": "agent",
             "text": "明白了，那请您尝试重启手机并检查是否有软件更新需要应用。如果问题仍然存在，请联系我们的售后服务进行进一步检查。"}
        ],
        "analysis": "客服提供了初步的故障排除方法，并指导用户进行软件更新检查，同时也预留了后续的售后服务选项，展现出了专业和负责的服务态度。"
    },
    {
        "dialogue": [
            {"role": "user", "text": "我的手机突然之间无法开机了。"},
            {"role": "agent",
             "text": "很抱歉给您带来不便。请问手机在无法开机之前有没有出现过任何异常现象，比如自动重启或者发热？"},
            {"role": "user", "text": "没有，就是突然用不了了。"},
            {"role": "agent",
             "text": "了解了，建议您先长按电源键10秒尝试强制重启。如果仍然无法开机，请携带购机发票和保修卡到就近的授权维修中心进行检查。"}
        ],
        "analysis": "客服首先指导用户进行强制重启尝试解决问题，随后提供了进一步的维修建议，体现了快速响应和解决问题的能力。"
    },
    {
        "dialogue": [
            {"role": "user", "text": "我手机上的一些应用总是自动退出，这是怎么回事？"},
            {"role": "agent", "text": "这可能是应用软件兼容性问题导致的。请问您是否尝试过更新这些应用到最新版本？"},
            {"role": "user", "text": "有一些我更新了，但问题还是存在。"},
            {"role": "agent",
             "text": "如果更新应用后问题仍旧存在，建议您备份重要数据后尝试恢复出厂设置。这样可以解决大部分软件兼容性问题。"}
        ],
        "analysis": "客服针对用户的问题提出了实用的解决方案，包括应用更新和恢复出厂设置，展现了专业的技术支持能力。"
    },
    {
        "dialogue": [
            {"role": "user", "text": "我想了解一下手机的保修政策。"},
            {"role": "agent",
             "text": "我们的手机提供一年保修服务，涵盖非人为损坏的硬件问题。请问您有遇到任何具体问题吗？"},
            {"role": "user", "text": "就是想了解下，没有遇到问题。"},
            {"role": "agent", "text": "好的，如果将来您遇到任何问题，都可以随时联系我们的客服或者就近的授权维修中心。"}
        ],
        "analysis": "客服清晰地解释了保修政策，并主动询问用户是否存在问题，体现了积极主动的服务态度。"
    },
    {
        "dialogue": [
            {"role": "user", "text": "我的手机最近老是发热，尤其是玩游戏的时候。"},
            {"role": "agent",
             "text": "手机在长时间高负荷运行时发热是正常现象。不过，如果发热程度过高，可能需要检查。请问发热是在使用特定应用时更明显吗？"},
            {"role": "user", "text": "对，玩某些游戏时特别明显。"},
            {"role": "agent",
             "text": "明白了，建议您定期清理手机后台应用，并尝试减少连续游戏时间。如果问题持续存在，建议您到授权维修中心进行专业检查。"}
        ],
        "analysis": "客服提出了合理的使用建议来减轻手机发热问题，并在必要时引导用户进行专业检查，既实用又负责。"
    },
    {
        "dialogue": [
            {"role": "user", "text": "我的手机经常自动重启，这是什么原因？"},
            {"role": "agent", "text": "您好，自动重启可能是由于软件冲突引起的。"},
            {"role": "user", "text": "那我该怎么解决呢？"},
            {"role": "agent", "text": "您可以尝试重置手机，但请先备份数据。"}
        ],
        "analysis": "客服直接建议用户重置手机而未提供详细诊断或其他解决步骤，可能让用户感到解决方案过于简单和粗暴。"
    },
    {
        "dialogue": [
            {"role": "user", "text": "我收到的手机外壳有划痕。"},
            {"role": "agent", "text": "请问您是在收到手机时立即发现划痕的吗？"},
            {"role": "user", "text": "是的，拆开快递时就发现了。"},
            {"role": "agent", "text": "那您需要提供快递单号和划痕的照片。"}
        ],
        "analysis": "客服要求用户提供额外信息而未立即表达歉意或提出解决方案，可能让用户感觉不够关心其遭遇。"
    },
    {
        "dialogue": [
            {"role": "user", "text": "我想知道我的订单什么时候发货。"},
            {"role": "agent", "text": "因为最近订单比较多，所以发货可能会稍微延迟。"},
            {"role": "user", "text": "能给一个具体的时间吗？"},
            {"role": "agent", "text": "我们正在加紧处理，希望尽快为您发货。"}
        ],
        "analysis": "客服未能提供具体的发货时间，缺乏明确的信息可能会让用户感到不满意。"
    },
    {
        "dialogue": [
            {"role": "user", "text": "我的手机屏幕边缘有一块不响应触摸。"},
            {"role": "agent", "text": "这种情况您可以尝试重启手机看看。"},
            {"role": "user", "text": "我试过了，但问题依旧。"},
            {"role": "agent", "text": "那可能是硬件问题，您需要送修。"}
        ],
        "analysis": "客服建议重启手机作为解决方案显得过于简单，且对于硬件问题的解决方案缺乏同情和详细指导。"
    },
    {
        "dialogue": [
            {"role": "user", "text": "我希望取消订单并退款。"},
            {"role": "agent", "text": "订单一旦下达就无法取消，您可以在收到商品后申请退货。"},
            {"role": "user", "text": "但我看网站上写的是可以在发货前取消订单的。"},
            {"role": "agent", "text": "这个规定最近有所更改，现在不支持这样做了。"}
        ],
        "analysis": "客服对订单取消政策的解释与用户所了解的信息不一致，缺乏透明度和及时更新的信息可能会引起用户不信任。"
    },
    {
        "dialogue": [
            {"role": "user", "text": "我预订的航班延误了，我可以申请赔偿吗？"},
            {"role": "agent", "text": "航班延误需要根据具体情况来判断是否符合赔偿条件。"},
            {"role": "user", "text": "那您能帮我查查我的航班符合条件吗？"},
            {"role": "agent", "text": "您需要自行在我们的网站上提交赔偿申请，客服无法直接为您查询。"}
        ],
        "analysis": "客服没有主动提供帮助查询赔偿条件，导致用户可能感到不便和不满。"
    },
    {
        "dialogue": [
            {"role": "user", "text": "我昨天转账时操作失败了，但是我的账户里的钱少了。"},
            {"role": "agent", "text": "这种情况通常是因为系统延迟，您可以等待24小时看看是否会自动退回。"},
            {"role": "user", "text": "如果24小时后还没有退回怎么办？"},
            {"role": "agent", "text": "那时您可以再联系我们，我们将为您手动处理。"}
        ],
        "analysis": "客服建议用户等待，但没有提供即时的解决方案或主动跟进服务，可能让用户感觉服务不够积极。"
    },
    {
        "dialogue": [
            {"role": "user", "text": "我这个月的话费怎么这么高？"},
            {"role": "agent", "text": "可能是因为您的数据使用超出了套餐范围。"},
            {"role": "user", "text": "可我并没有收到超额使用的提醒。"},
            {"role": "agent", "text": "提醒服务有时可能会有延迟，建议您定期检查数据使用情况。"}
        ],
        "analysis": "客服解释了可能的原因但没有对未发送提醒表示歉意，也未提供具体解决方法，可能导致用户满意度不高。"
    },
    {
        "dialogue": [
            {"role": "user", "text": "我购买的课程视频一直加载不出来。"},
            {"role": "agent", "text": "可能是网络问题，建议您换一个网络环境试试。"},
            {"role": "user", "text": "我已经尝试过了，还是不行。"},
            {"role": "agent", "text": "那我建议您清理缓存后再试。"}
        ],
        "analysis": "客服提供了标准解决方案，但未能针对用户的具体情况提供个性化帮助或进一步的技术支持。"
    },
    {
        "dialogue": [
            {"role": "user", "text": "我买的洗衣机在使用一个月后出现了噪音问题。"},
            {"role": "agent", "text": "噪音问题通常是物品卡在滚筒里造成的，您检查过滚筒里是否有异物吗？"},
            {"role": "user", "text": "检查过了，里面没有任何东西。"},
            {"role": "agent", "text": "那您可以尝试重新调整洗衣机的位置，确保洗衣机水平放置。"}
        ],
        "analysis": "虽然客服提供了可能的解决方案，但似乎没有认真对待用户反馈的问题，也没有提供上门检修的选项或进一步的技术支持。"
    }

]

# 保存为.jsonl文件
file_path = "customer_service_dialogues.jsonl"
with open(file_path, "w", encoding="utf-8") as file:
    for item in data:
        file.write(json.dumps(item) + "\n")

# # 测试
# s1 = "是否可以无条件退换"
# s2 = "那好吧，不过我还是有点担心。你能保证如果我购买后出现问题，可以无条件退换吗?"
# print(string_similar(s1, s2))
